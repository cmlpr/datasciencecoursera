getwd()
setwd("/Users/cemalperozen/Documents/Repos/datasciencecoursera/ExplatoryDataAnalysis")
dir()
dir("Data/")
unzip("Data/NEI_data.zip", exdir = "Data/")
dir("Data/")
NEI <- readRDS("Data/summarySCC_PM25.rds")
SCC <- readRDS("Data/Source_Classification_Code.rds")
head(NEI)
str(NEI)
head(SCC)
#### Question 1
library(plyr)
library(ggplot2)
ddply(NEI, c("type", "year"), function(x) sum(x[which(x$fips == "24510"),4]))
data <- ddply(NEI, c("type", "year"), function(x) sum(x[which(x$fips == "24510"),4]))
qplot(year, V1, data = data, facets = . ~ type)
data
eSumBalt <- sapply(NEI2, function(x) sum(x[which(x$fips == "24510"),4]))
NEI2 <- split(NEI, NEI$year)
eSumBalt <- sapply(NEI2, function(x) sum(x[which(x$fips == "24510"),4]))
plot(years, eSumBalt, xlab = "Years", ylab = "Total Emission in Baltimore",  main = "Total Emission in Baltimore in Years")
years <- unique(NEI$year)
plot(years, eSumBalt, xlab = "Years", ylab = "Total Emission in Baltimore",  main = "Total Emission in Baltimore in Years")
qplot(year, V1, data = data, facets = . ~ type)
colnames(data) <- c("Type", "Year", "TotalEmission")
qplot(year, V1, data = data, facets = . ~ type)
data
qplot(Year, TotalEmission, data = data, facets = . ~ Type)
qplot(Year, TotalEmission, data = data, facets = . ~ Type, title = "Baltimore Total Emissions with Time for Each Type")
qplot(Year, TotalEmission, data = data, facets = . ~ Type, main = "Baltimore Total Emissions with Time for Each Type")
qplot(Year, TotalEmission, data = data, facets = . ~ Type, main = "Total Emissions in Baltiomore with Time for Each Type")
SCC[1,1]
SCC[1,2]
SCC[1,3]
SCC[1,4]
SCC[1,5]
names(SCC)
head(SCC)
head(NEI)
str(NEI)
head(SCC)
table(SCC)
View(SCC)
coal <- unique(SSC$EI.Sector)
coal <- unique(SCC$EI.Sector)
coal
unique(grep("coal", SCC$EI.Sector, ignore.case=TRUE, value =TRUE))
unique(grep("coal", SCC$EI.Sector, ignore.case=TRUE))
unique(grep("coal", SCC$EI.Sector, ignore.case=TRUE, value = TRUE))
unique(grep("coal", SCC$EI.Sector, ignore.case=TRUE, value = TRUE))
sectors <- unique(grep("coal", SCC$EI.Sector, ignore.case=TRUE, value = TRUE))
str(sectors)
grepl("coal", SCC$EI.Sector, ignore.case=TRUE)
sccsubset <- subset(SCC, grepl("coal", EI.Sector, ignore.case=TRUE), select=c(SCC, EI.Sector))
sccsubset
sccCode <- SCC[1, SCC$EI.Sector %in% sectors]
sccCode <- SCC[1, which(SCC$EI.Sector %in% sectors)]
str(SCC)
sccCode <- SCC[which(SCC$EI.Sector %in% sectors), 1]
sccCode
str(SCC)
sccCode <- unqiue(SCC[which(SCC$EI.Sector %in% sectors), 1])
sccCode <- unique(SCC[which(SCC$EI.Sector %in% sectors), 1])
sccCode
sccCode <- unique(as.numeric(SCC[which(SCC$EI.Sector %in% sectors), 1]))
sccCode
sccCode <- unique(as.character(SCC[which(SCC$EI.Sector %in% sectors), 1]))
sccCode
?grep
sccsubset <- subset(SCC, grepl("comb", Short.Name, ignore.case=TRUE))
sccsubset
sccsubset <- subset(sccsubset, grepl("coal", Short.Name, ignore.case=TRUE))
?grepl
sccsubset <- subset(SCC, grepl("coal", EI.Sector, ignore.case=TRUE), select=c(SCC, EI.Sector))
sccCode <- unique(as.character(SCC[which(SCC$EI.Sector %in% sectors), 1]))
sccCode
sccCode <- SCC[which(SCC$EI.Sector %in% sectors), 1]
sccCode
sccCode <- levels(SCC[which(SCC$EI.Sector %in% sectors), 1])
sccCode
sccCode <- SCC[which(SCC$EI.Sector %in% sectors), 1]
sccCode <- as.factor(SCC[which(SCC$EI.Sector %in% sectors), 1])
sccCode
sccCode <- SCC[which(SCC$EI.Sector %in% sectors), 1]
sccsubset <- subset(SCC, grepl("coal", EI.Sector, ignore.case=TRUE), select=c(SCC, EI.Sector))
sccCode <- SCC[which(SCC$EI.Sector %in% sectors), 1]
sccCode
sccsubset <- subset(SCC, grepl("coal", EI.Sector, ignore.case=TRUE), select=c(SCC, EI.Sector))
sccsubset
?merge
str(sccsubset)
str(NEI)
NEI4 <- merge(NEI, sccsubset)
str(NEI4)
head(NEI4)
head(NEI4, 100)
tail(NEI4, 100)
summary(NEI4)
sccCode
sccCode <- as.character(SCC[which(SCC$EI.Sector %in% sectors), 1])
sccCode
sccCode <- unique(as.character(SCC[which(SCC$EI.Sector %in% sectors), 1]))
sccCode
unique(NEI4$SCC)
NEI[NEI$SCC == "10100235",]
summary(NEI4)
str(NEI4)
levels(NEI4)
levels(NEI4$EI.Sector)
str(NEI4)
summary(NEI4)
View(NEI4)
data <- ddply(NEI4, c("year"), function(x) sum(x[ ,4]))
data
colnames(data) <- c("Year", "TotalEmission")
qplot(Year, TotalEmission, data = data, main = "Total Emissions from Coal Cumbustion-Related Sources Across US")
data <- ddply(NEI4, c("year", "EI.Sector"), function(x) sum(x[ ,4]))
data
qplot(Year, TotalEmission, data = data, facets = . ~ Sector, main = "Total Emissions from Coal Cumbustion-Related Sources Across US by Sector")
data <- ddply(NEI4, c("year", "EI.Sector"), function(x) sum(x[ ,4]))
data
colnames(data) <- c("Year", "Sector", "TotalEmission")
qplot(Year, TotalEmission, data = data, facets = . ~ Sector, main = "Total Emissions from Coal Cumbustion-Related Sources Across US by Sector")
head(SCC)
unique(SCC4$EI.Sector)
unique(SCC$EI.Sector)
names(SCC)
unique(SCC$Data.Category)
unique(SCC$Short.Name)
unique(SCC$EI.Sector)
head(unique(SCC$Short.Name))
head(unique(SCC$Short.Name), 100)
sccsubset <- subset(SCC, grepl("motor", Short.Name, ignore.case=TRUE), select=c(SCC, EI.Sector))
sccsubset
sccsubset <- subset(SCC, grepl("motor", Short.Name, ignore.case=TRUE), select=c(SCC, EI.Sector, Short.Name))
sccsubset
sccsubset <- subset(SCC, grepl("mobile", EI.Sector, ignore.case=TRUE), select=c(SCC, EI.Sector, Short.Name))
sccsubset
head(sccsubset,100)
tail(sccsubset,100)
NEI5 <- merge(NEI, sccsubset)
NEI5 <- merge(NEI, sccsubset)
sccsubset <- subset(SCC, grepl("mobile", EI.Sector, ignore.case=TRUE), select=c(SCC, EI.Sector))
head(sccsubset,100)
tail(sccsubset,100)
NEI5 <- merge(NEI, sccsubset)
data <- ddply(NEI5, c("year"), function(x) sum(x[which(x$fips == "24510"),4]))
data
colnames(data) <- c("Year", "TotalEmission")
qplot(Year, TotalEmission, data = data, main = "Total Emissions in Years from Motor Veh. in Baltimore")
data <- ddply(NEI5, c("year", "EI.Sector"), function(x) sum(x[which(x$fips == "24510"),4]))
data
colnames(data) <- c("Year", "Sector", "TotalEmission")
data
colnames(data) <- c("Year", "Sector", "TotalEmission")
qplot(Year, TotalEmission, data = data, facets = . ~ Sector, main = "Total Emissions from Motor Veh. in Baltimore by Sector")
head(NEI5)
data <- ddply(NEI5, c("year", "fips"), function(x) sum(x[,4]))
data
str(data)
colnames(data) <- c("Year", "Fips", "TotalEmission")
str(data)
?ddply
data <- ddply(NEI5, c("year", "fips"), function(x) sum(x[which(x$fips == "24510" || x$fips == "06037"),4]))
str(data)
data[which(data$V1 > 0),]
data <- data[which(data$V1 > 0),]
colnames(data) <- c("Year", "Fips", "TotalEmission")
str(data)
qplot(Year, TotalEmission, data = data, facets = . ~ Fips, main = "Motor Vehicle Emissions in Baltimore and LA")
p <- ggplot(data, aes(Year, TotalEmission)) + geom_point()
p <- ggplot(data, aes(Year, TotalEmission)) + geom_point()
p + facet_grid(. ~ Fips)
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_point()
p + facet_grid(. ~ Fips)
p + facet_grid(. ~ Fips, labeller = c("Bal", "LA"))
levels(data$Fips)
levels(factor(data$Fips))
data <- transform(data, Fips = factor(Fips))
str(data)
levels(data$Fips) <- c("Baltimore", "Los Angles")
str(data)
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_point()
p + facet_grid(. ~ Fips, labeller = c("Bal", "LA"))
p + facet_grid(. ~ Fips)
dir()
# See the content of the Data folder
dir("Data/")
head(NEI)
str(NEI)
head(NEI)
str(NEI)
names(NEI)
# Since we are asked to have years in x axis, we need to get the unique values
years <- unique(NEI$year)
NEI2 <- split(NEI, NEI$year)
str(NEI2)
eSum
eSum <- sapply(NEI2, function(x) sum(x[,4]))
eSum
plot(years, eSum, type = "l", xlab = "Years", ylab = "Total Emission", main = "Total Emission in Years")
eSum <- sapply(NEI2, function(x) sum(x[,4]))
eSum # This will show the result
# It is time to plot it to a png file
png(file = "plot1.png", width = 480, height = 480, units = "px")
plot(years, eSum, type = "l", xlab = "Years", ylab = "Total Emission", main = "Total Emission in Years")
dev.off() #close the device
eSumBalt <- sapply(NEI2, function(x) sum(x[which(x$fips == "24510"),4]))
eSumBalt # This will show the result
# It is time to plot it to a png file
# It is time to plot it to a png file
png(file = "plot2.png", width = 480, height = 480, units = "px")
plot(years, eSumBalt, type = "l", xlab = "Years", ylab = "Total Emission", main = "Total Emission in Baltimore")
dev.off() #close the device
data <- ddply(NEI, c("type", "year"), function(x) sum(x[which(x$fips == "24510"),4]))
data #look at the data
# Change the column names
colnames(data) <- c("Type", "Year", "TotalEmission")
# It is time to plot it to a png file
library(ggplot2) # Call ggplot2 which is a requirement
png(file = "plot3.png", width = 480, height = 480, units = "px")
qplot(Year, TotalEmission, data = data, facets = . ~ Type, main = "Total Emissions in Baltiomore with Time for Each Type")
dev.off() #close the device
library(ggplot2) # Call ggplot2 which is a requirement
png(file = "plot3.png", width = 480, height = 480, units = "px")
qplot(Year, TotalEmission, data = data, facets = Type ~ . , main = "Total Emissions in Baltiomore with Time for Each Type")
dev.off() #close the device
qplot(Year, TotalEmission, data = data, facets = Type ~ . , colour = factor(Type), main = "Total Emissions in Baltiomore with Time for Each Type")
# It is time to plot it to a png file
library(ggplot2) # Call ggplot2 which is a requirement
png(file = "plot3.png", width = 480, height = 480, units = "px")
qplot(Year, TotalEmission, data = data, facets = Type ~ . , colour = factor(Type), main = "Total Emissions in Baltiomore for each Type")
dev.off() #close the device
?subset
coal <- subset(SCC, grepl("coal", EI.Sector, ignore.case=TRUE), select=c(SCC, EI.Sector))
NEI4 <- merge(NEI, coal)
str(NEI4)
str(NEI4) # Let's look at the data
levels(NEI4$EI.Sector)
str(NEI4) # Let's look at the data
data <- ddply(NEI4, c("year"), function(x) sum(x[ , 4]))
data #look at the data
colnames(data) <- c("Year", "TotalEmission")
qplot(Year, TotalEmission, data = data, type = "l", main = "Emissions from Coal Comb-Rltd Src Across US")
qplot(Year, TotalEmission, data = data, main = "Emissions from Coal Comb-Rltd Src Across US")
png(file = "plot4.png", width = 480, height = 480, units = "px")
qplot(Year, TotalEmission, data = data, main = "Emissions from Coal Comb-Rltd Src Across US")
dev.off() #close the device
qplot(Year, TotalEmission, data = data, main = "Emissions from Coal Comb-Rltd Src Across US")
library(ggplot2) # Call ggplot2 which is a requirement
png(file = "plot4.png", width = 480, height = 480, units = "px")
qplot(Year, TotalEmission, data = data, main = "Emissions from Coal Comb-Rltd Src Across US")
dev.off() #close the device
qplot(Year, TotalEmission, data = data, size = 4, main = "Emissions from Coal Comb-Rltd Src Across US")
qplot(Year, TotalEmission, data = data, main = "Emissions from Coal Comb-Rltd Src Across US")
dev.off() #close the device
mobile <- subset(SCC, grepl("mobile", EI.Sector, ignore.case=TRUE), select=c(SCC, EI.Sector))
# Now we have the necessary scc codes in coal data frame
# We can merge the NEI and caol data frames by using matching column names
# Merge function is useful for this
?merge
NEI5 <- merge(NEI, mobile) # This implementation will only keep the matching rows
data <- ddply(NEI5, c("year"), function(x) sum(x[which(x$fips == "24510"),4]))
data #look at the data
# Change the column names
colnames(data) <- c("Year", "TotalEmission")
# It is time to plot it to a png file
library(ggplot2) # Call ggplot2 which is a requirement
library(ggplot2) # Call ggplot2 which is a requirement
png(file = "plot5.png", width = 480, height = 480, units = "px")
qplot(Year, TotalEmission, data = data, main = " Total Emissions from Motor Veh. in Baltimore")
dev.off() #close the device
data
data <- ddply(NEI5, c("year", "fips"), function(x) sum(x[which(x$fips == "24510" || x$fips == "06037"),4]))
# Since I only calculated sums for two fips numbers, the rest of fips will
# have 0 for the total emission value, let's see
data
data <- data[which(data$TotalEmission > 0),]
str(data)
data
data <- ddply(NEI5, c("year", "fips"), function(x) sum(x[which(x$fips == "24510" || x$fips == "06037"),4]))
head(data,20)
# Change the column names
colnames(data) <- c("Year", "Fips", "TotalEmission")
head(data,20)
data <- data[which(data$TotalEmission > 0),]
data
library(ggplot2) # Call ggplot2 which is a requirement
png(file = "plot6.png", width = 480, height = 480, units = "px")
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_point()
p + facet_grid(. ~ Fips)
p + labs(title = "Motor Vch. Emission Comparison")
dev.off() #close the device
library(ggplot2) # Call ggplot2 which is a requirement
png(file = "plot6.png", width = 480, height = 480, units = "px")
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_point()
p + facet_grid(. ~ Fips)
p + labs(title = "Motor Vch. Emission Comparison")
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_line()
p + facet_grid(. ~ Fips)
p + labs(title = "Motor Vch. Emission Comparison")
dev.off() #close the device
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_line()
p + facet_grid(. ~ Fips)
p + labs(title = "Motor Vch. Emission Comparison")
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_line()
p + facet_grid(. ~ Fips)
colnames(data) <- c("Year", "Fips", "TotalEmission")
# Keep the rows that have non-zero values in Total Emission column
data <- data[which(data$TotalEmission > 0),]
data # Let's look at the data now
# Change the Fips column to a factor variable
data <- transform(data, Fips = factor(Fips))
# Change the numbers of fips to city names
levels(data$Fips) <- c("Baltimore", "Los Angles")
str(data) # check the data
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_line()
p + facet_grid(. ~ Fips)
p + labs(title = "Motor Vch. Emission Comparison")
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_line()
p + facet_grid(. ~ Fips)
png(file = "plot6.png", width = 480, height = 480, units = "px")
p <- ggplot(data, aes(Year, TotalEmission, colour = factor(Fips))) + geom_line()
p + facet_grid(. ~ Fips)
dev.off() #close the device
